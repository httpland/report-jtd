{
  "properties": {
    "age": { "type": "float32" },
    "type": { "enum": ["csp-violation"] },
    "url": { "type": "string" },
    "user_agent": { "type": "string" },
    "body": {
      "properties": {
        "documentURL": {
          "type": "string",
          "metadata": {
            "description": "Violation's URL."
          }
        },
        "effectiveDirective": {
          "type": "string",
          "metadata": {
            "description": "Violation's effective directive."
          }
        },
        "originalPolicy": {
          "type": "string",
          "metadata": {
            "description": "The serialization of violation's policy."
          }
        },
        "statusCode": {
          "type": "uint16",
          "metadata": { "description": "Violation's status." }
        },
        "disposition": {
          "enum": ["enforce", "report"],
          "metadata": {
            "description": "The disposition of violation's policy."
          }
        }
      },
      "optionalProperties": {
        "referrer": {
          "type": "string",
          "metadata": {
            "description": "Violation's referrer."
          }
        },
        "blockedURL": {
          "type": "string",
          "metadata": {
            "description": "Violation's resource."
          }
        },
        "sourceFile": { "type": "string" },
        "sample": {
          "type": "string",
          "metadata": {
            "description": "Violation's sample"
          }
        },
        "lineNumber": {
          "type": "uint32",
          "metadata": {
            "description": "Violation's line number"
          }
        },
        "columnNumber": {
          "type": "uint32",
          "metadata": {
            "description": "Violation's column number"
          }
        }
      }
    }
  }
}
